---
layout: post
title: 22. Active Directory Introduction and Enumeration
subtitle: 22. Active Directory 소개 및 열거
author: 마준영
categories: oscp
tags:
  - oscp
---
# 22. Active Directory 소개 및 열거
### AD란?
AD는 대규모 환경에서 운영 체제, 애플리케이션, 사용자, 데이터 액세스를 관리하는 서비스로, 기본적으로 설정되어 설치되지만 조직의 필요에 따라 맞춤 설정될 수 있음.
### 공격자 입장에서 AD의 중요성
1. AD에는 많은 정보가 포함되어 있어 해킹의 주요 대상이 됨.
2. 특정 객체(사용자, 그룹 등)를 탈취하면 조직 전체의 인프라를 장악할 수 도 있음.

## 22.1. Active Directory - 소개
#### **AD의 역할**

- AD는 단순한 서비스가 아니라, 환경을 관리하는 **관리 계층** 역할을 수행.
- 사용자(User), 그룹(Group), 컴퓨터(Computer)와 같은 객체(Object)를 저장하고 관리함.
- 각 객체에는 **권한(Permission)**이 설정되어 있으며, 해당 권한에 따라 도메인 내에서의 역할이 결정됨.

#### **AD 환경 구성**

- **도메인(Domain)**
    
    - AD 인스턴스를 설정할 때 가장 먼저 **도메인 이름**(예: `corp.com`)을 생성함.
    - 이 도메인 내에서 컴퓨터, 사용자, 그룹 등의 객체가 추가됨.
- **도메인 컨트롤러(Domain Controller, DC)**
    
    - 도메인의 핵심 역할을 하는 서버.
    - **DNS 서버**도 함께 운영되어야 하며, 도메인의 공식적인 네임 서버 역할을 수행함.
- **조직 단위(Organizational Units, OU)**
    
    - 파일 시스템의 폴더처럼, **AD 객체를 논리적으로 그룹화**하는 컨테이너.
    - 시스템 관리자가 OUs를 활용하여 사용자를 효율적으로 관리함.
- **AD 객체(Object) 및 속성(Attribute)**
    
    - **사용자 객체(User Object):** 사용자 계정 정보(이름, ID, 전화번호 등)를 포함.
    - **컴퓨터 객체(Computer Object):** 도메인에 가입된 서버 및 워크스테이션을 나타냄.
    - 각 객체에는 다양한 속성이 포함되며, 객체 유형에 따라 속성이 다름.

### AD의 주요 보안 요소 및 공격자 관점
#### **도메인 컨트롤러(DC)의 중요성**

- 사용자가 로그인하면 **도메인 컨트롤러(DC)**가 인증 요청을 확인하고, 해당 사용자가 로그인할 수 있는지 검증함.
- DC에는 모든 도메인의 **OU, 객체, 속성**이 저장되어 있으며, 공격자들은 DC를 장악하는 것을 목표로 함.

#### **AD 그룹 및 권한**

- AD에서는 **그룹(Group)** 개념을 활용하여 다수의 객체(사용자, 컴퓨터 등)를 한꺼번에 관리함.
- 예를 들어, 특정 파일 서버에 접근 권한이 필요한 사용자를 그룹으로 묶어 한 번에 권한을 부여할 수 있음.
- 하지만 **공격자들은 높은 권한을 가진 그룹을 주요 타겟으로 삼음.**

#### **도메인 관리자(Domain Admins) 그룹**

- 도메인 내에서 가장 높은 권한을 가진 그룹.
- **Domain Admins 그룹을 탈취하면 전체 도메인을 장악 가능.**
- 공격자들은 이 그룹의 멤버를 해킹하여 권한을 상승시키는 공격을 수행함.

#### **도메인 트리와 포레스트**

- 하나의 AD 인스턴스가 **여러 개의 도메인**을 포함할 수 있음.
- 다수의 도메인이 모이면 **도메인 트리(Domain Tree)**가 되고, 여러 개의 도메인 트리가 모이면 **도메인 포레스트(Domain Forest)**가 됨.
- 포레스트 내의 모든 도메인을 관리하는 그룹이 **Enterprise Admins 그룹**이며, 이 그룹을 해킹하면 전체 포레스트를 장악할 수 있음.